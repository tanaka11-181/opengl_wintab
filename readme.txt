SwapBuffersを用いた際のWT_PACKETの遅延について

初めまして、慶應義塾大学メディアデザイン研究科の田中博和です。私は、研究の一環としてWintab APIとOpenGl、WinAPIを用いたペイントアプリケーションを開発しています。御社のペンタブレットからのパケットを受付け、OpenGLとWinAPIによって処理を行うプログラムです。
ところが、WintabとOpenGLをダブルバッファリングさせるSwapBuffers関数を同じメッセージループ内で実行すると、ペンで入力してから、プログラムにWT_PACKETが届くまでの間に遅延が生じてしまいます。調べた所、GetMessageによるメッセージループ内でSwapBuffers関数を用いるとこの現象が生じるようです。更に、既に処理を終えたシリアル番号のWT_PACKETがGetMessageから重複して取得されてしまうことも頻発します。マウスイベント等、他のメッセージは正常に取得されることから、GetMessageに届く時点ですでに遅延等の問題が生じていると思われます。SwapBuffers関数をコメントアウト等によって実行させないと、この遅延は一切起こりません。しかし、OpenGLによる描画を行うにはSwapBuffers関数の使用が必要です。

以下に、本プログラムのソースファイルを添付します。Visual Studio 2013を使って作成しました。
OpenGLに必要なdllやlib等は全て同じフォルダに纏めてあります。使用しているタブレットはCintiq 22HD, 13HD, ペンはアートペン、グリップペンです。
https://www.dropbox.com/s/uo4j3nzwh2txnqu/Opengl_wintab.zip?dl=0

この遅延を解消し、本問題の解決に向けて、
何卒ご協力の程よろしくお願いいたします。

田中博和
